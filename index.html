<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>EasyFund - Investment & Loan Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --accent-color: #06d6a0;
            --bg-light: #f8fafc;
            --bg-dark: #1e293b;
            --text-light: #334155;
            --text-dark: #f1f5f9;
            --card-light: #ffffff;
            --card-dark: #334155;
            --border-light: #e2e8f0;
            --border-dark: #475569;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-light);
            transition: all 0.3s ease;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        body.dark {
            background: var(--bg-dark);
            color: var(--text-dark);
        }

        body.rtl {
            direction: rtl;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            min-height: 100vh;
            position: relative;
        }

        /* Animated Background - Optimized for mobile */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.05;
            pointer-events: none;
        }

        .floating-shapes {
            position: absolute;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }

        .floating-shapes:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .floating-shapes:nth-child(2) { top: 20%; right: 20%; animation-delay: 2s; }
        .floating-shapes:nth-child(3) { bottom: 30%; left: 30%; animation-delay: 4s; }
        .floating-shapes:nth-child(4) { bottom: 10%; right: 10%; animation-delay: 6s; }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(180deg); }
        }

        /* Header - Mobile Optimized */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 2px solid var(--border-light);
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        body.dark .header {
            border-bottom-color: var(--border-dark);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            flex-shrink: 0;
        }

        .header-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .toggle-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            min-width: 60px;
            white-space: nowrap;
        }

        .toggle-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }

        /* Cards - Mobile Optimized */
        .card {
            background: var(--card-light);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            border: 1px solid var(--border-light);
            width: 100%;
            overflow: hidden;
        }

        body.dark .card {
            background: var(--card-dark);
            border-color: var(--border-dark);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.15);
        }

        /* Forms - Mobile Optimized */
        .form-group {
            margin-bottom: 15px;
            width: 100%;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 14px;
        }

        .form-group input, 
        .form-group select, 
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: var(--card-light);
            color: var(--text-light);
            -webkit-appearance: none;
            appearance: none;
        }

        body.dark .form-group input,
        body.dark .form-group select,
        body.dark .form-group textarea {
            background: var(--card-dark);
            border-color: var(--border-dark);
            color: var(--text-dark);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            color: var(--text-light);
            font-size: 12px;
            opacity: 0.7;
        }

        /* Buttons - Mobile Optimized */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            white-space: nowrap;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, var(--accent-color), #20bf6b);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
        }

        /* Dashboard Grid - Mobile Responsive */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .stat-card:hover {
            transform: scale(1.02);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 8px;
            word-break: break-all;
        }

        /* Navigation - Mobile Optimized */
        .nav-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            padding: 3px;
            background: var(--card-light);
            border-radius: 12px;
            border: 1px solid var(--border-light);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        body.dark .nav-tabs {
            background: var(--card-dark);
            border-color: var(--border-dark);
        }

        .nav-tab {
            flex: 1;
            padding: 10px 8px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-light);
            font-size: 12px;
            white-space: nowrap;
            min-width: 70px;
            text-align: center;
        }

        body.dark .nav-tab {
            color: var(--text-dark);
        }

        .nav-tab.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            transform: scale(1.02);
        }

        /* Wallet Display - Mobile Optimized */
        .wallet-display {
            background: linear-gradient(135deg, var(--accent-color), #20bf6b);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .wallet-balance {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            word-break: break-all;
        }

        .wallet-display .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .wallet-display .btn {
            flex: 1;
            min-width: 120px;
        }

        /* Investment Cards - Mobile Grid */
        .investment-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .investment-card {
            background: var(--card-light);
            border: 2px solid var(--border-light);
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        body.dark .investment-card {
            background: var(--card-dark);
            border-color: var(--border-dark);
        }

        .investment-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary-color);
        }

        .investment-card h4 {
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 16px;
        }

        .investment-card p {
            margin-bottom: 8px;
            font-size: 14px;
        }

        /* Progress Bar - Mobile Optimized */
        .progress-bar {
            width: 100%;
            height: 15px;
            background: var(--border-light);
            border-radius: 8px;
            overflow: hidden;
            margin: 10px 0;
        }

        body.dark .progress-bar {
            background: var(--border-dark);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            border-radius: 8px;
            transition: width 1s ease;
        }

        /* Modal - Mobile Optimized */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(3px);
            padding: 10px;
        }

        .modal-content {
            background: var(--card-light);
            padding: 20px;
            border-radius: 15px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: all 0.3s ease;
            margin: 10px;
        }

        body.dark .modal-content {
            background: var(--card-dark);
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
            font-size: 18px;
        }

        .modal .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .modal .btn-group .btn {
            flex: 1;
        }

        /* Transaction History - Mobile Optimized */
        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 12px;
            border-bottom: 1px solid var(--border-light);
            transition: all 0.3s ease;
            flex-wrap: wrap;
            gap: 10px;
        }

        body.dark .transaction-item {
            border-bottom-color: var(--border-dark);
        }

        .transaction-item:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .transaction-left {
            flex: 1;
            min-width: 200px;
        }

        .transaction-right {
            text-align: right;
            flex-shrink: 0;
        }

        .transaction-left strong {
            font-size: 14px;
            display: block;
            margin-bottom: 5px;
        }

        .transaction-left small,
        .transaction-right small {
            font-size: 12px;
            opacity: 0.7;
        }

        .transaction-right strong {
            font-size: 16px;
            display: block;
            margin-bottom: 3px;
        }

        /* Quick Actions Grid - Mobile */
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        /* Admin Panel - Mobile Optimized */
        #adminPanel .transaction-item {
            border: 2px solid var(--primary-color);
            margin-bottom: 10px;
            border-radius: 8px;
            background: var(--card-light);
        }

        body.dark #adminPanel .transaction-item {
            background: var(--card-dark);
        }

        .admin-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 100px;
        }

        .admin-actions .btn {
            margin-bottom: 0;
            padding: 8px 12px;
            font-size: 12px;
        }

        /* Responsive Typography */
        h1 { font-size: 1.8rem; }
        h2 { font-size: 1.5rem; margin-bottom: 15px; }
        h3 { font-size: 1.3rem; margin-bottom: 12px; }
        h4 { font-size: 1.1rem; margin-bottom: 10px; }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 20px;
        }

        .spinner {
            width: 30px;
            height: 30px;
            border: 3px solid var(--border-light);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notification - Mobile Optimized */
        .notification {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 9999;
            font-size: 14px;
            text-align: center;
        }

        /* RTL Optimizations */
        .rtl .card,
        .rtl .transaction-item {
            text-align: right;
        }

        .rtl .form-group input,
        .rtl .form-group select,
        .rtl .form-group textarea {
            text-align: right;
        }

        .rtl .transaction-right {
            text-align: left;
        }

        .rtl .transaction-left {
            text-align: right;
        }

        /* Tablet Responsive (481px - 768px) */
        @media (min-width: 481px) {
            .container {
                padding: 15px;
            }

            .logo {
                font-size: 2.2rem;
            }

            .wallet-balance {
                font-size: 2.5rem;
            }

            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .investment-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal .btn-group {
                flex-direction: row;
            }

            .wallet-display .btn-group {
                justify-content: center;
            }

            .wallet-display .btn {
                flex: 0 1 auto;
                min-width: 140px;
            }
        }

        /* Desktop Responsive (769px+) */
        @media (min-width: 769px) {
            .container {
                max-width: 1200px;
                padding: 20px;
            }

            .header {
                flex-wrap: nowrap;
            }

            .logo {
                font-size: 2.5rem;
            }

            .wallet-balance {
                font-size: 3rem;
            }

            .dashboard-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .investment-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }

            .quick-actions {
                grid-template-columns: repeat(3, 1fr);
            }

            .nav-tab {
                font-size: 14px;
                padding: 15px 20px;
            }

            .card {
                padding: 30px;
            }

            .btn {
                width: auto;
                display: inline-flex;
                margin-right: 10px;
            }

            .transaction-item {
                flex-wrap: nowrap;
            }

            .notification {
                top: 20px;
                left: auto;
                right: 20px;
                max-width: 350px;
            }
        }

        /* Landscape Mobile Adjustments */
        @media (max-height: 500px) and (orientation: landscape) {
            .wallet-display {
                padding: 15px;
            }

            .wallet-balance {
                font-size: 1.8rem;
                margin-bottom: 10px;
            }

            .card {
                padding: 15px;
                margin-bottom: 15px;
            }

            .modal-content {
                max-height: 85vh;
            }
        }

        /* High DPI Displays */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .floating-shapes {
                width: 50px;
                height: 50px;
            }
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .floating-shapes {
                animation: none;
            }
        }

        /* Focus Improvements for Accessibility */
        .btn:focus,
        .nav-tab:focus,
        .toggle-btn:focus {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        /* Safe Area for iOS devices with notches */
        @supports (padding: max(0px)) {
            .container {
                padding-left: max(10px, env(safe-area-inset-left));
                padding-right: max(10px, env(safe-area-inset-right));
                padding-top: max(10px, env(safe-area-inset-top));
                padding-bottom: max(10px, env(safe-area-inset-bottom));
            }

            .notification {
                top: max(10px, env(safe-area-inset-top));
                left: max(10px, env(safe-area-inset-left));
                right: max(10px, env(safe-area-inset-right));
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="floating-shapes"></div>
        <div class="floating-shapes"></div>
        <div class="floating-shapes"></div>
        <div class="floating-shapes"></div>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo" data-en="EasyFund" data-ar="Ø¥ÙŠØ²ÙŠ ÙØ§Ù†Ø¯">EasyFund</div>
            <div class="header-controls">
                <button class="toggle-btn" onclick="toggleLanguage()" data-en="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" data-ar="English">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
                <button class="toggle-btn" onclick="toggleTheme()" data-en="ðŸŒ™" data-ar="ðŸŒ™">ðŸŒ™</button>
                <button class="toggle-btn" onclick="logout()" id="logoutBtn" data-en="Logout" data-ar="ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬" style="display: none;">Logout</button>
            </div>
        </div>

        <!-- Authentication Section -->
        <div id="authSection">
            <div class="card">
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="showLogin()" data-en="Login" data-ar="ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„">Login</button>
                    <button class="nav-tab" onclick="showSignup()" data-en="Sign Up" data-ar="Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">Sign Up</button>
                </div>

                <!-- Login Form -->
                <div id="loginForm">
                    <h2 data-en="Welcome Back!" data-ar="Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ!">Welcome Back!</h2>
                    <div class="form-group">
                        <label data-en="Email" data-ar="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">Email</label>
                        <input type="email" id="loginEmail" placeholder="john@example.com">
                    </div>
                    <div class="form-group">
                        <label data-en="Password" data-ar="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">Password</label>
                        <input type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>
                    <button class="btn btn-primary" onclick="login()" data-en="Login" data-ar="ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„">Login</button>
                </div>

                <!-- Signup Form -->
                <div id="signupForm" class="hidden">
                    <h2 data-en="Create Account" data-ar="Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">Create Account</h2>
                    <div class="form-group">
                        <label data-en="Full Name" data-ar="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">Full Name</label>
                        <input type="text" id="signupName" placeholder="John Doe">
                    </div>
                    <div class="form-group">
                        <label data-en="Email" data-ar="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">Email</label>
                        <input type="email" id="signupEmail" placeholder="john@example.com">
                    </div>
                    <div class="form-group">
                        <label data-en="Password" data-ar="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">Password</label>
                        <input type="password" id="signupPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>
                    <div class="form-group">
                        <label data-en="Referral Code (Optional)" data-ar="ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">Referral Code (Optional)</label>
                        <input type="text" id="referralCode" placeholder="Enter referral code">
                    </div>
                    <button class="btn btn-primary" onclick="signup()" data-en="Create Account" data-ar="Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨">Create Account</button>
                </div>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboardSection" class="hidden">
            <!-- Wallet Display -->
            <div class="wallet-display">
                <div data-en="Wallet Balance" data-ar="Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©">Wallet Balance</div>
                <div class="wallet-balance" id="walletBalance">â‚¦0.00</div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="showDepositModal()" data-en="Deposit" data-ar="Ø¥ÙŠØ¯Ø§Ø¹">Deposit</button>
                    <button class="btn btn-danger" onclick="showWithdrawModal()" data-en="Withdraw" data-ar="Ø³Ø­Ø¨">Withdraw</button>
                </div>
            </div>

            <!-- Main Navigation -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showDashboard()" data-en="Dashboard" data-ar="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…">Dashboard</button>
                <button class="nav-tab" onclick="showLoans()" data-en="Loans" data-ar="Ø§Ù„Ù‚Ø±ÙˆØ¶">Loans</button>
                <button class="nav-tab" onclick="showInvestments()" data-en="Investments" data-ar="Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª">Investments</button>
                <button class="nav-tab" onclick="showTransactions()" data-en="History" data-ar="Ø§Ù„ØªØ§Ø±ÙŠØ®">History</button>
                <button class="nav-tab" onclick="showReferrals()" data-en="Referrals" data-ar="Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª">Referrals</button>
            </div>

            <!-- Dashboard Overview -->
            <div id="dashboardContent">
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalInvestments">0</div>
                        <div data-en="Active Investments" data-ar="Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©">Active Investments</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalLoans">0</div>
                        <div data-en="Active Loans" data-ar="Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø§Ù„Ù†Ø´Ø·Ø©">Active Loans</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalReferrals">0</div>
                        <div data-en="Referrals Made" data-ar="Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©">Referrals Made</div>
                    </div>
                </div>

                <div class="card">
                    <h3 data-en="Quick Actions" data-ar="Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©">Quick Actions</h3>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="showLoans()" data-en="Apply for Loan" data-ar="Ø·Ù„Ø¨ Ù‚Ø±Ø¶">Apply for Loan</button>
                        <button class="btn btn-success" onclick="showInvestments()" data-en="Start Investment" data-ar="Ø¨Ø¯Ø¡ Ø§Ø³ØªØ«Ù…Ø§Ø±">Start Investment</button>
                        <button class="btn btn-primary" onclick="showReferrals()" data-en="Invite Friends" data-ar="Ø¯Ø¹ÙˆØ© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡">Invite Friends</button>
                    </div>
                </div>
            </div>

            <!-- Loans Section -->
            <div id="loansContent" class="hidden">
                <div class="card">
                    <h3 data-en="Loan Application" data-ar="Ø·Ù„Ø¨ Ù‚Ø±Ø¶">Loan Application</h3>
                    <div id="loanForm">
                        <div class="form-group">
                            <label data-en="Full Name" data-ar="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">Full Name</label>
                            <input type="text" id="loanName" placeholder="Enter full name">
                        </div>
                        <div class="form-group">
                            <label data-en="National ID Number" data-ar="Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©">National ID Number</label>
                            <input type="text" id="loanNationalId" placeholder="Enter national ID">
                        </div>
                        <div class="form-group">
                            <label data-en="Phone Number" data-ar="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">Phone Number</label>
                            <input type="tel" id="loanPhone" placeholder="Enter phone number">
                        </div>
                        <div class="form-group">
                            <label data-en="Loan Amount (â‚¦)" data-ar="Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø±Ø¶ (â‚¦)">Loan Amount (â‚¦)</label>
                            <input type="number" id="loanAmount" placeholder="Enter amount" min="1000">
                            <small data-en="You need 20% of loan amount in your wallet" data-ar="ØªØ­ØªØ§Ø¬ 20% Ù…Ù† Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø±Ø¶ ÙÙŠ Ù…Ø­ÙØ¸ØªÙƒ">You need 20% of loan amount in your wallet</small>
                        </div>
                        <button class="btn btn-primary" onclick="applyLoan()" data-en="Apply for Loan" data-ar="Ø·Ù„Ø¨ Ø§Ù„Ù‚Ø±Ø¶">Apply for Loan</button>
                    </div>
                </div>

                <div class="card" id="activeLoanCard" style="display: none;">
                    <h3 data-en="Active Loan" data-ar="Ø§Ù„Ù‚Ø±Ø¶ Ø§Ù„Ù†Ø´Ø·">Active Loan</h3>
                    <div id="activeLoanDetails"></div>
                </div>
            </div>

            <!-- Investments Section -->
            <div id="investmentsContent" class="hidden">
                <div class="card">
                    <h3 data-en="New Investment" data-ar="Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¬Ø¯ÙŠØ¯">New Investment</h3>
                    <div class="form-group">
                        <label data-en="Investment Type" data-ar="Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±">Investment Type</label>
                        <select id="investmentType">
                            <option value="">Select investment type</option>
                            <option value="Real Estate">Real Estate</option>
                            <option value="Cryptocurrency">Cryptocurrency</option>
                            <option value="Palm Oil">Palm Oil</option>
                            <option value="Agriculture">Agriculture</option>
                            <option value="Technology">Technology</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-en="Custom Investment (Optional)" data-ar="Ø§Ø³ØªØ«Ù…Ø§Ø± Ù…Ø®ØµØµ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">Custom Investment (Optional)</label>
                        <input type="text" id="customInvestment" placeholder="Enter custom investment type">
                    </div>
                    <div class="form-group">
                        <label data-en="Investment Amount (Min â‚¦5,000)" data-ar="Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ â‚¦5,000)">Investment Amount (Min â‚¦5,000)</label>
                        <input type="number" id="investmentAmount" placeholder="5000" min="5000">
                    </div>
                    <div class="card" style="background: linear-gradient(135deg, var(--accent-color), #20bf6b); color: white; text-align: center;">
                        <h4 data-en="Investment Plan" data-ar="Ø®Ø·Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±">Investment Plan</h4>
                        <p data-en="Invest â‚¦5,000 and get â‚¦30,000 in 7 days" data-ar="Ø§Ø³ØªØ«Ù…Ø± â‚¦5,000 ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ â‚¦30,000 ÙÙŠ 7 Ø£ÙŠØ§Ù…">Invest â‚¦5,000 and get â‚¦30,000 in 7 days</p>
                        <p data-en="600% Return on Investment!" data-ar="Ø¹Ø§Ø¦Ø¯ 600% Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±!">600% Return on Investment!</p>
                    </div>
                    <button class="btn btn-success" onclick="makeInvestment()" data-en="Start Investment" data-ar="Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±">Start Investment</button>
                </div>

                <div class="investment-grid" id="investmentsList"></div>
            </div>

            <!-- Transactions Section -->
            <div id="transactionsContent" class="hidden">
                <div class="card">
                    <h3 data-en="Transaction History" data-ar="ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª">Transaction History</h3>
                    <div id="transactionsList"></div>
                </div>
            </div>

            <!-- Referrals Section -->
            <div id="referralsContent" class="hidden">
                <div class="card">
                    <h3 data-en="Referral System" data-ar="Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©">Referral System</h3>
                    <p data-en="Invite friends and earn â‚¦500 for each successful referral!" data-ar="Ø§Ø¯Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§ÙƒØ³Ø¨ â‚¦500 Ù„ÙƒÙ„ Ø¥Ø­Ø§Ù„Ø© Ù†Ø§Ø¬Ø­Ø©!">Invite friends and earn â‚¦500 for each successful referral!</p>
                    <div class="form-group">
                        <label data-en="Your Referral Code" data-ar="ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ">Your Referral Code</label>
                        <input type="text" id="userReferralCode" readonly>
                        <button class="btn btn-primary" onclick="copyReferralCode()" style="margin-top: 10px;" data-en="Copy Code" data-ar="Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯">Copy Code</button>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="referralEarnings">â‚¦0</div>
                        <div data-en="Total Referral Earnings" data-ar="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©">Total Referral Earnings</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deposit Modal -->
        <div id="depositModal" class="modal">
            <div class="modal-content">
                <h3 data-en="Deposit Money" data-ar="Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ù„Ù…Ø§Ù„">Deposit Money</h3>
                <p data-en="Transfer money to the account below and wait for admin confirmation:" data-ar="Ø­ÙˆÙ„ Ø§Ù„Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£Ø¯Ù†Ø§Ù‡ ÙˆØ§Ù†ØªØ¸Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø¯ÙŠØ±:">Transfer money to the account below and wait for admin confirmation:</p>
                <div class="card">
                    <strong data-en="Bank Details" data-ar="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ù†Ùƒ">Bank Details</strong><br>
                    <strong data-en="Account Number:" data-ar="Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:">Account Number:</strong> 6109172525<br>
                    <strong data-en="Bank:" data-ar="Ø§Ù„Ø¨Ù†Ùƒ:">Bank:</strong> Opay<br>
                    <strong data-en="Account Name:" data-ar="Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:">Account Name:</strong> EasyFund
                </div>
                <div class="form-group">
                    <label data-en="Amount You Sent (â‚¦)" data-ar="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„ (â‚¦)">Amount You Sent (â‚¦)</label>
                    <input type="number" id="depositAmount" placeholder="Enter amount you transferred">
                </div>
                <div class="form-group">
                    <label data-en="Transaction Reference" data-ar="Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©">Transaction Reference</label>
                    <input type="text" id="transactionRef" placeholder="Enter transaction reference/ID">
                </div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="submitDepositRequest()" data-en="Submit Request" data-ar="Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨">Submit Request</button>
                    <button class="btn btn-danger" onclick="closeModal('depositModal')" data-en="Cancel" data-ar="Ø¥Ù„ØºØ§Ø¡">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Withdraw Modal -->
        <div id="withdrawModal" class="modal">
            <div class="modal-content">
                <h3 data-en="Withdraw Money" data-ar="Ø³Ø­Ø¨ Ø§Ù„Ù…Ø§Ù„">Withdraw Money</h3>
                <div class="form-group">
                    <label data-en="Bank Name" data-ar="Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ">Bank Name</label>
                    <input type="text" id="withdrawBank" placeholder="Enter bank name">
                </div>
                <div class="form-group">
                    <label data-en="Account Number" data-ar="Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨">Account Number</label>
                    <input type="text" id="withdrawAccount" placeholder="Enter account number">
                </div>
                <div class="form-group">
                    <label data-en="Amount (Min â‚¦1,000)" data-ar="Ø§Ù„Ù…Ø¨Ù„Øº (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ â‚¦1,000)">Amount (Min â‚¦1,000)</label>
                    <input type="number" id="withdrawAmount" placeholder="Enter amount" min="1000">
                </div>
                <div class="btn-group">
                    <button class="btn btn-danger" onclick="processWithdraw()" data-en="Withdraw" data-ar="Ø³Ø­Ø¨">Withdraw</button>
                    <button class="btn btn-primary" onclick="closeModal('withdrawModal')" data-en="Cancel" data-ar="Ø¥Ù„ØºØ§Ø¡">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="hidden">
            <div class="card">
                <h3>Admin Dashboard</h3>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="adminTotalUsers">0</div>
                        <div>Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="adminTotalDeposits">â‚¦0</div>
                        <div>Total Deposits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="adminTotalLoans">â‚¦0</div>
                        <div>Total Loans</div>
                    </div>
                </div>
            </div>
            
            <!-- Pending Deposits Section -->
            <div class="card">
                <h3>Pending Deposit Requests</h3>
                <div id="pendingDeposits"></div>
            </div>
            
            <!-- User Management Section -->
            <div class="card">
                <h3>User Management</h3>
                <div class="form-group">
                    <label>Select User</label>
                    <select id="adminUserSelect">
                        <option value="">Select a user</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Credit Amount (â‚¦)</label>
                    <input type="number" id="adminCreditAmount" placeholder="Enter amount to credit">
                </div>
                <button class="btn btn-success" onclick="adminCreditUser()">Credit User Wallet</button>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentUser = null;
        let currentLanguage = 'en';
        let isDarkMode = false;
        let users = [];
        let investments = [];
        let loans = [];
        let transactions = [];
        let depositRequests = [];

        // Initialize storage if needed
        function initStorage() {
            try {
                users = JSON.parse(localStorage.getItem('easyfund_users') || '[]');
                investments = JSON.parse(localStorage.getItem('easyfund_investments') || '[]');
                loans = JSON.parse(localStorage.getItem('easyfund_loans') || '[]');
                transactions = JSON.parse(localStorage.getItem('easyfund_transactions') || '[]');
                depositRequests = JSON.parse(localStorage.getItem('easyfund_depositRequests') || '[]');
            } catch (e) {
                console.error('Error loading data from localStorage:', e);
                // Reset data if corrupted
                users = [];
                investments = [];
                loans = [];
                transactions = [];
                depositRequests = [];
                saveAllData();
            }
        }

        function saveAllData() {
            try {
                localStorage.setItem('easyfund_users', JSON.stringify(users));
                localStorage.setItem('easyfund_investments', JSON.stringify(investments));
                localStorage.setItem('easyfund_loans', JSON.stringify(loans));
                localStorage.setItem('easyfund_transactions', JSON.stringify(transactions));
                localStorage.setItem('easyfund_depositRequests', JSON.stringify(depositRequests));
            } catch (e) {
                console.error('Error saving data to localStorage:', e);
            }
        }

        // Language Translations
        const translations = {
            en: {
                welcome: "Welcome Back!",
                createAccount: "Create Account",
                login: "Login",
                signup: "Sign Up",
                email: "Email",
                password: "Password",
                fullName: "Full Name",
                walletBalance: "Wallet Balance",
                deposit: "Deposit",
                withdraw: "Withdraw",
                loans: "Loans",
                investments: "Investments",
                dashboard: "Dashboard",
                history: "History",
                referrals: "Referrals"
            },
            ar: {
                welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ!",
                createAccount: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
                login: "ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„",
                signup: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
                email: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
                password: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
                fullName: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",
                walletBalance: "Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",
                deposit: "Ø¥ÙŠØ¯Ø§Ø¹",
                withdraw: "Ø³Ø­Ø¨",
                loans: "Ø§Ù„Ù‚Ø±ÙˆØ¶",
                investments: "Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª",
                dashboard: "Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
                history: "Ø§Ù„ØªØ§Ø±ÙŠØ®",
                referrals: "Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª"
            }
        };

        // Initialize App
        function initApp() {
            initStorage();
            checkAuthStatus();
            updateLanguage();
            loadUserData();
            setInterval(checkInvestmentMaturity, 60000); // Check every minute
            startRealTimeUpdates();
        }

        // Authentication Functions
        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab')[0].classList.add('active');
        }

        function showSignup() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab')[1].classList.add('active');
        }

        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert(currentLanguage === 'en' ? 'Please fill all fields' : 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('easyfund_currentUser', JSON.stringify(user));
                showDashboardSection();
                animateLogin();
            } else {
                alert(currentLanguage === 'en' ? 'Invalid credentials' : 'Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦Ø©');
            }
        }

        function signup() {
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const referralCode = document.getElementById('referralCode').value.trim();

            if (!name || !email || !password) {
                alert(currentLanguage === 'en' ? 'Please fill all fields' : 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            if (!validateEmail(email)) {
                alert(currentLanguage === 'en' ? 'Please enter a valid email' : 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­');
                return;
            }

            const passwordValidation = validatePassword(password);
            if (!passwordValidation.isValid) {
                alert(passwordValidation.errors.join('\n'));
                return;
            }

            if (users.find(u => u.email === email)) {
                alert(currentLanguage === 'en' ? 'Email already exists' : 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„');
                return;
            }

            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                wallet: 0,
                referralCode: generateReferralCode(),
                referredBy: referralCode,
                referralEarnings: 0,
                joinDate: new Date()
            };

            // Process referral bonus
            if (referralCode) {
                const referrer = users.find(u => u.referralCode === referralCode);
                if (referrer) {
                    referrer.wallet += 500;
                    referrer.referralEarnings += 500;
                    addTransaction(referrer.id, 'referral', 500, 'Referral bonus');
                }
            }

            users.push(newUser);
            currentUser = newUser;
            saveAllData();
            localStorage.setItem('easyfund_currentUser', JSON.stringify(newUser));
            
            showDashboardSection();
            animateSignup();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('easyfund_currentUser');
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('logoutBtn').style.display = 'none';
            
            // Clear forms
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            clearAllForms();
        }

        function checkAuthStatus() {
            try {
                const savedUser = localStorage.getItem('easyfund_currentUser');
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    // Refresh user data from storage
                    const userInStorage = users.find(u => u.id === currentUser.id);
                    if (userInStorage) {
                        currentUser = userInStorage;
                        localStorage.setItem('easyfund_currentUser', JSON.stringify(currentUser));
                    }
                    showDashboardSection();
                }
            } catch (e) {
                console.error('Error checking auth status:', e);
                localStorage.removeItem('easyfund_currentUser');
            }
        }

        function showDashboardSection() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('dashboardSection').classList.remove('hidden');
            document.getElementById('logoutBtn').style.display = 'block';
            
            // Show admin panel if admin user
            if (currentUser && currentUser.email === 'admin@easyfund.com') {
                showAdminPanel();
            }
            
            updateWalletDisplay();
            showDashboard();
        }

        // Navigation Functions
        function showDashboard() {
            hideAllContent();
            document.getElementById('dashboardContent').classList.remove('hidden');
            updateDashboardStats();
            setActiveTab(0);
        }

        function showLoans() {
            hideAllContent();
            document.getElementById('loansContent').classList.remove('hidden');
            loadActiveLoan();
            setActiveTab(1);
        }

        function showInvestments() {
            hideAllContent();
            document.getElementById('investmentsContent').classList.remove('hidden');
            loadInvestments();
            setActiveTab(2);
        }

        function showTransactions() {
            hideAllContent();
            document.getElementById('transactionsContent').classList.remove('hidden');
            loadTransactions();
            setActiveTab(3);
        }

        function showReferrals() {
            hideAllContent();
            document.getElementById('referralsContent').classList.remove('hidden');
            loadReferrals();
            setActiveTab(4);
        }

        function hideAllContent() {
            document.getElementById('dashboardContent').classList.add('hidden');
            document.getElementById('loansContent').classList.add('hidden');
            document.getElementById('investmentsContent').classList.add('hidden');
            document.getElementById('transactionsContent').classList.add('hidden');
            document.getElementById('referralsContent').classList.add('hidden');
        }

        function setActiveTab(index) {
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            const tabs = document.querySelectorAll('.nav-tab');
            if (tabs[index]) {
                tabs[index].classList.add('active');
            }
        }

        function clearAllForms() {
            // Clear all form inputs
            const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="password"], input[type="number"], input[type="tel"], select, textarea');
            inputs.forEach(input => {
                if (!input.readOnly) {
                    input.value = '';
                }
            });
        }

        // Wallet Functions
        function updateWalletDisplay() {
            if (currentUser) {
                document.getElementById('walletBalance').textContent = `â‚¦${currentUser.wallet.toLocaleString()}.00`;
                // Update user in storage
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    saveAllData();
                }
                animateWalletUpdate();
            }
        }

        function showDepositModal() {
            document.getElementById('depositModal').classList.add('show');
            document.getElementById('depositModal').style.display = 'flex';
            // Clear previous values
            document.getElementById('depositAmount').value = '';
            document.getElementById('transactionRef').value = '';
        }

        function showWithdrawModal() {
            if (currentUser.wallet < 1000) {
                alert(currentLanguage === 'en' ? 'Minimum withdrawal is â‚¦1,000' : 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ù‡Ùˆ â‚¦1,000');
                return;
            }
            document.getElementById('withdrawModal').classList.add('show');
            document.getElementById('withdrawModal').style.display = 'flex';
            // Clear previous values
            document.getElementById('withdrawBank').value = '';
            document.getElementById('withdrawAccount').value = '';
            document.getElementById('withdrawAmount').value = '';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
            setTimeout(() => {
                document.getElementById(modalId).style.display = 'none';
            }, 300);
        }

        function submitDepositRequest() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            const transactionRef = document.getElementById('transactionRef').value.trim();
            
            if (!amount || amount <= 0) {
                alert(currentLanguage === 'en' ? 'Please enter valid amount' : 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­');
                return;
            }
            
            if (!transactionRef) {
                alert(currentLanguage === 'en' ? 'Please enter transaction reference' : 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©');
                return;
            }

            const depositRequest = {
                id: Date.now(),
                userId: currentUser.id,
                userName: currentUser.name,
                userEmail: currentUser.email,
                amount: amount,
                transactionRef: transactionRef,
                status: 'pending',
                requestDate: new Date()
            };

            depositRequests.push(depositRequest);
            saveAllData();
            
            closeModal('depositModal');
            
            alert(currentLanguage === 'en' ? 
                'Deposit request submitted! Admin will review and credit your account within 24 hours.' : 
                'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹! Ø³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ø¯ÙŠØ± Ø¨Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©.');
        }

        function processWithdraw() {
            const bank = document.getElementById('withdrawBank').value.trim();
            const account = document.getElementById('withdrawAccount').value.trim();
            const amount = parseFloat(document.getElementById('withdrawAmount').value);

            if (!bank || !account || !amount) {
                alert(currentLanguage === 'en' ? 'Please fill all fields' : 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            if (amount < 1000) {
                alert(currentLanguage === 'en' ? 'Minimum withdrawal is â‚¦1,000' : 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ù‡Ùˆ â‚¦1,000');
                return;
            }

            if (amount > currentUser.wallet) {
                alert(currentLanguage === 'en' ? 'Insufficient balance' : 'Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ');
                return;
            }

            currentUser.wallet -= amount;
            addTransaction(currentUser.id, 'withdrawal', -amount, `Withdrawal to ${bank} - ${account}`);
            updateWalletDisplay();
            closeModal('withdrawModal');
            
            showNotification(currentLanguage === 'en' ? 
                `â‚¦${amount.toLocaleString()} withdrawal processed!` : 
                `ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø³Ø­Ø¨ â‚¦${amount.toLocaleString()}!`);
        }

        // Loan Functions
        function applyLoan() {
            const name = document.getElementById('loanName').value.trim();
            const nationalId = document.getElementById('loanNationalId').value.trim();
            const phone = document.getElementById('loanPhone').value.trim();
            const amount = parseFloat(document.getElementById('loanAmount').value);

            if (!name || !nationalId || !phone || !amount) {
                alert(currentLanguage === 'en' ? 'Please fill all fields' : 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            if (amount < 1000) {
                alert(currentLanguage === 'en' ? 'Minimum loan amount is â‚¦1,000' : 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø±Ø¶ Ù‡Ùˆ â‚¦1,000');
                return;
            }

            // Check if user already has active loan
            const activeLoan = loans.find(l => l.userId === currentUser.id && l.status === 'active');
            if (activeLoan) {
                alert(currentLanguage === 'en' ? 'You already have an active loan' : 'Ù„Ø¯ÙŠÙƒ Ù‚Ø±Ø¶ Ù†Ø´Ø· Ø¨Ø§Ù„ÙØ¹Ù„');
                return;
            }

            const requiredAmount = amount * 0.2;
            if (currentUser.wallet < requiredAmount) {
                alert(currentLanguage === 'en' ? 
                    `You need â‚¦${requiredAmount.toLocaleString()} in your wallet (20% of loan amount). Current balance: â‚¦${currentUser.wallet.toLocaleString()}` : 
                    `ØªØ­ØªØ§Ø¬ â‚¦${requiredAmount.toLocaleString()} ÙÙŠ Ù…Ø­ÙØ¸ØªÙƒ (20% Ù…Ù† Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø±Ø¶). Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: â‚¦${currentUser.wallet.toLocaleString()}`);
                return;
            }

            const newLoan = {
                id: Date.now(),
                userId: currentUser.id,
                name,
                nationalId,
                phone,
                amount,
                status: 'active',
                date: new Date(),
                dueDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 days
            };

            loans.push(newLoan);

            // Add loan amount to wallet
            currentUser.wallet += amount;
            addTransaction(currentUser.id, 'loan', amount, `Loan approved - â‚¦${amount.toLocaleString()}`);
            updateWalletDisplay();
            loadActiveLoan();
            saveAllData();

            // Clear form
            document.getElementById('loanName').value = '';
            document.getElementById('loanNationalId').value = '';
            document.getElementById('loanPhone').value = '';
            document.getElementById('loanAmount').value = '';

            showNotification(currentLanguage === 'en' ? 'Loan approved successfully!' : 'ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­!');
        }

        function loadActiveLoan() {
            const activeLoan = loans.find(l => l.userId === currentUser.id && l.status === 'active');
            const activeLoanCard = document.getElementById('activeLoanCard');
            
            if (activeLoan) {
                activeLoanCard.style.display = 'block';
                document.getElementById('activeLoanDetails').innerHTML = `
                    <p><strong>${currentLanguage === 'en' ? 'Amount' : 'Ø§Ù„Ù…Ø¨Ù„Øº'}:</strong> â‚¦${activeLoan.amount.toLocaleString()}</p>
                    <p><strong>${currentLanguage === 'en' ? 'Status' : 'Ø§Ù„Ø­Ø§Ù„Ø©'}:</strong> ${activeLoan.status}</p>
                    <p><strong>${currentLanguage === 'en' ? 'Date' : 'Ø§Ù„ØªØ§Ø±ÙŠØ®'}:</strong> ${new Date(activeLoan.date).toLocaleDateString()}</p>
                    <p><strong>${currentLanguage === 'en' ? 'Due Date' : 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚'}:</strong> ${new Date(activeLoan.dueDate).toLocaleDateString()}</p>
                `;
                // Hide loan form
                document.getElementById('loanForm').style.display = 'none';
            } else {
                activeLoanCard.style.display = 'none';
                document.getElementById('loanForm').style.display = 'block';
            }
        }

        // Investment Functions
        function makeInvestment() {
            const type = document.getElementById('investmentType').value;
            const custom = document.getElementById('customInvestment').value.trim();
            const amount = parseFloat(document.getElementById('investmentAmount').value);

            const investmentType = custom || type;
            
            if (!investmentType || !amount) {
                alert(currentLanguage === 'en' ? 'Please fill all fields' : 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            if (amount < 5000) {
                alert(currentLanguage === 'en' ? 'Minimum investment is â‚¦5,000' : 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ù‡Ùˆ â‚¦5,000');
                return;
            }

            // Enhanced wallet validation
            if (currentUser.wallet < amount) {
                const shortfall = amount - currentUser.wallet;
                alert(currentLanguage === 'en' ? 
                    `Insufficient balance! You need â‚¦${shortfall.toLocaleString()} more. Current balance: â‚¦${currentUser.wallet.toLocaleString()}` : 
                    `Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ! ØªØ­ØªØ§Ø¬ â‚¦${shortfall.toLocaleString()} Ø¥Ø¶Ø§ÙÙŠØ©. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: â‚¦${currentUser.wallet.toLocaleString()}`);
                return;
            }

            // Double confirm investment
            const confirmMessage = currentLanguage === 'en' ? 
                `Confirm investment of â‚¦${amount.toLocaleString()} in ${investmentType}?\n\nYou will receive â‚¦${(amount * 6).toLocaleString()} in 7 days.` :
                `ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªØ«Ù…Ø§Ø± â‚¦${amount.toLocaleString()} ÙÙŠ ${investmentType}ØŸ\n\nØ³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ â‚¦${(amount * 6).toLocaleString()} ÙÙŠ 7 Ø£ÙŠØ§Ù….`;
                
            if (!confirm(confirmMessage)) {
                return;
            }

            const newInvestment = {
                id: Date.now(),
                userId: currentUser.id,
                type: investmentType,
                amount,
                returnAmount: amount * 6, // 600% return
                status: 'active',
                startDate: new Date(),
                maturityDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7 days
                progress: 0
            };

            investments.push(newInvestment);

            // Deduct from wallet
            currentUser.wallet -= amount;
            addTransaction(currentUser.id, 'investment', -amount, `Investment in ${investmentType}`);
            updateWalletDisplay();
            loadInvestments();
            saveAllData();

            // Clear form
            document.getElementById('investmentType').value = '';
            document.getElementById('customInvestment').value = '';
            document.getElementById('investmentAmount').value = '';

            showNotification(currentLanguage === 'en' ? 
                `Investment of â‚¦${amount.toLocaleString()} in ${investmentType} started successfully!` : 
                `ØªÙ… Ø¨Ø¯Ø¡ Ø§Ø³ØªØ«Ù…Ø§Ø± â‚¦${amount.toLocaleString()} ÙÙŠ ${investmentType} Ø¨Ù†Ø¬Ø§Ø­!`);
        }

        function loadInvestments() {
            const userInvestments = investments.filter(i => i.userId === currentUser.id);
            const investmentsList = document.getElementById('investmentsList');
            
            if (userInvestments.length === 0) {
                investmentsList.innerHTML = `
                    <div class="card" style="text-align: center; padding: 40px;">
                        <h4>${currentLanguage === 'en' ? 'No Investments Yet' : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª Ø¨Ø¹Ø¯'}</h4>
                        <p>${currentLanguage === 'en' ? 'Start your first investment to see it here' : 'Ø§Ø¨Ø¯Ø£ Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ù„Ø±Ø¤ÙŠØªÙ‡ Ù‡Ù†Ø§'}</p>
                    </div>
                `;
                return;
            }
            
            investmentsList.innerHTML = userInvestments.map(investment => {
                const progress = calculateInvestmentProgress(investment);
                const daysLeft = Math.max(0, Math.ceil((new Date(investment.maturityDate) - new Date()) / (1000 * 60 * 60 * 24)));
                
                return `
                    <div class="investment-card">
                        <h4>${investment.type}</h4>
                        <p><strong>${currentLanguage === 'en' ? 'Amount' : 'Ø§Ù„Ù…Ø¨Ù„Øº'}:</strong> â‚¦${investment.amount.toLocaleString()}</p>
                        <p><strong>${currentLanguage === 'en' ? 'Expected Return' : 'Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹'}:</strong> â‚¦${investment.returnAmount.toLocaleString()}</p>
                        <p><strong>${currentLanguage === 'en' ? 'Status' : 'Ø§Ù„Ø­Ø§Ù„Ø©'}:</strong> <span style="color: ${investment.status === 'active' ? 'green' : 'blue'}">${investment.status}</span></p>
                        <p><strong>${currentLanguage === 'en' ? 'Days Left' : 'Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©'}:</strong> ${investment.status === 'active' ? daysLeft : 0}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                        <p style="text-align: center; margin-top: 5px; font-weight: bold;">${Math.round(progress)}% ${currentLanguage === 'en' ? 'Complete' : 'Ù…ÙƒØªÙ…Ù„'}</p>
                    </div>
                `;
            }).join('');
        }

        function calculateInvestmentProgress(investment) {
            const now = new Date();
            const start = new Date(investment.startDate);
            const end = new Date(investment.maturityDate);
            
            if (investment.status === 'completed') return 100;
            
            const total = end - start;
            const elapsed = now - start;
            return Math.min(100, Math.max(0, (elapsed / total) * 100));
        }

        function checkInvestmentMaturity() {
            if (!currentUser) return;
            
            const now = new Date();
            let hasMaturedInvestments = false;
            
            investments.forEach(investment => {
                if (investment.status === 'active' && new Date(investment.maturityDate) <= now) {
                    // Mature the investment
                    investment.status = 'completed';
                    hasMaturedInvestments = true;
                    
                    // Add return to user wallet
                    const user = users.find(u => u.id === investment.userId);
                    if (user) {
                        user.wallet += investment.returnAmount;
                        addTransaction(user.id, 'investment_return', investment.returnAmount, 
                            `Investment return - ${investment.type}`);
                        
                        if (user.id === currentUser.id) {
                            currentUser = user;
                            updateWalletDisplay();
                            showNotification(
                                currentLanguage === 'en' ? 
                                `Your ${investment.type} investment has matured! â‚¦${investment.returnAmount.toLocaleString()} added to your wallet.` :
                                `Ù„Ù‚Ø¯ Ù†Ø¶Ø¬ Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ ÙÙŠ ${investment.type}! ØªÙ… Ø¥Ø¶Ø§ÙØ© â‚¦${investment.returnAmount.toLocaleString()} Ø¥Ù„Ù‰ Ù…Ø­ÙØ¸ØªÙƒ.`
                            );
                        }
                    }
                }
            });
            
            if (hasMaturedInvestments) {
                saveAllData();
                if (document.getElementById('investmentsContent').classList.contains('hidden') === false) {
                    loadInvestments();
                }
            }
        }

        // Transaction Functions
        function addTransaction(userId, type, amount, description) {
            const transaction = {
                id: Date.now() + Math.random(), // Ensure unique ID
                userId,
                type,
                amount,
                description,
                date: new Date()
            };
            transactions.push(transaction);
            saveAllData();
        }

        function loadTransactions() {
            const userTransactions = transactions
                .filter(t => t.userId === currentUser.id)
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            const transactionsList = document.getElementById('transactionsList');
            
            if (userTransactions.length === 0) {
                transactionsList.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h4>${currentLanguage === 'en' ? 'No Transactions Yet' : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¨Ø¹Ø¯'}</h4>
                        <p>${currentLanguage === 'en' ? 'Your transactions will appear here' : 'Ø³ØªØ¸Ù‡Ø± Ù…Ø¹Ø§Ù…Ù„Ø§ØªÙƒ Ù‡Ù†Ø§'}</p>
                    </div>
                `;
                return;
            }
            
            transactionsList.innerHTML = userTransactions.map(transaction => `
                <div class="transaction-item">
                    <div class="transaction-left">
                        <strong>${transaction.description}</strong><br>
                        <small>${new Date(transaction.date).toLocaleDateString()} ${new Date(transaction.date).toLocaleTimeString()}</small>
                    </div>
                    <div class="transaction-right">
                        <strong style="color: ${transaction.amount > 0 ? '#06d6a0' : '#ff6b6b'}">
                            ${transaction.amount > 0 ? '+' : ''}â‚¦${Math.abs(transaction.amount).toLocaleString()}
                        </strong><br>
                        <small style="text-transform: capitalize;">${transaction.type.replace('_', ' ')}</small>
                    </div>
                </div>
            `).join('');
        }

        // Referral Functions
        function generateReferralCode() {
            return 'EF' + Math.random().toString(36).substr(2, 6).toUpperCase();
        }

        function loadReferrals() {
            document.getElementById('userReferralCode').value = currentUser.referralCode;
            document.getElementById('referralEarnings').textContent = `â‚¦${(currentUser.referralEarnings || 0).toLocaleString()}`;
            
            const referralCount = users.filter(u => u.referredBy === currentUser.referralCode).length;
            document.getElementById('totalReferrals').textContent = referralCount;
        }

        function copyReferralCode() {
            const referralCode = document.getElementById('userReferralCode');
            referralCode.select();
            referralCode.setSelectionRange(0, 99999); // For mobile devices
            
            try {
                document.execCommand('copy');
                showNotification(currentLanguage === 'en' ? 'Referral code copied!' : 'ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©!');
            } catch (err) {
                // Fallback for mobile
                if (navigator.share) {
                    navigator.share({
                        title: 'EasyFund Referral Code',
                        text: `Join EasyFund using my referral code: ${currentUser.referralCode}`,
                    });
                } else {
                    showNotification(currentLanguage === 'en' ? 'Please copy manually: ' + currentUser.referralCode : 'ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠØ§Ù‹: ' + currentUser.referralCode);
                }
            }
        }

        // Dashboard Stats
        function updateDashboardStats() {
            const userInvestments = investments.filter(i => i.userId === currentUser.id && i.status === 'active');
            const userLoans = loans.filter(l => l.userId === currentUser.id && l.status === 'active');
            const referralCount = users.filter(u => u.referredBy === currentUser.referralCode).length;

            document.getElementById('totalInvestments').textContent = userInvestments.length;
            document.getElementById('totalLoans').textContent = userLoans.length;
            document.getElementById('totalReferrals').textContent = referralCount;
        }

        // Theme and Language Functions
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark', isDarkMode);
            document.querySelector('[onclick="toggleTheme()"]').textContent = isDarkMode ? 'â˜€ï¸' : 'ðŸŒ™';
            localStorage.setItem('easyfund_darkMode', isDarkMode);
        }

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
            document.body.classList.toggle('rtl', currentLanguage === 'ar');
            updateLanguage();
            localStorage.setItem('easyfund_language', currentLanguage);
        }

        function updateLanguage() {
            document.querySelectorAll('[data-en]').forEach(element => {
                const enText = element.getAttribute('data-en');
                const arText = element.getAttribute('data-ar');
                if (enText && arText) {
                    element.textContent = currentLanguage === 'en' ? enText : arText;
                }
            });
        }

        function loadUserData() {
            const savedTheme = localStorage.getItem('easyfund_darkMode');
            const savedLanguage = localStorage.getItem('easyfund_language');
            
            if (savedTheme === 'true') {
                toggleTheme();
            }
            
            if (savedLanguage) {
                currentLanguage = savedLanguage;
                if (currentLanguage === 'ar') {
                    document.body.classList.add('rtl');
                }
                updateLanguage();
            }
        }

        // Animation Functions
        function animateLogin() {
            const walletDisplay = document.querySelector('.wallet-display');
            if (walletDisplay) {
                walletDisplay.style.transform = 'scale(0.8)';
                walletDisplay.style.opacity = '0';
                setTimeout(() => {
                    walletDisplay.style.transition = 'all 0.5s ease';
                    walletDisplay.style.transform = 'scale(1)';
                    walletDisplay.style.opacity = '1';
                }, 100);
            }
        }

        function animateSignup() {
            const cards = document.querySelectorAll('#dashboardSection .card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        function animateWalletUpdate() {
            const balance = document.getElementById('walletBalance');
            if (balance) {
                balance.style.transform = 'scale(1.1)';
                balance.style.color = 'var(--accent-color)';
                setTimeout(() => {
                    balance.style.transform = 'scale(1)';
                    balance.style.color = 'white';
                }, 300);
            }
        }

        // Admin Functions
        function showAdminPanel() {
            if (currentUser && currentUser.email === 'admin@easyfund.com') {
                document.getElementById('adminPanel').classList.remove('hidden');
                updateAdminStats();
                loadPendingDeposits();
                loadAdminUserSelect();
            }
        }

        function updateAdminStats() {
            const totalUsers = users.filter(u => u.email !== 'admin@easyfund.com').length;
            const totalDeposits = transactions
                .filter(t => t.type === 'deposit')
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
            const totalLoans = loans
                .filter(l => l.status === 'active')
                .reduce((sum, l) => sum + l.amount, 0);

            document.getElementById('adminTotalUsers').textContent = totalUsers;
            document.getElementById('adminTotalDeposits').textContent = `â‚¦${totalDeposits.toLocaleString()}`;
            document.getElementById('adminTotalLoans').textContent = `â‚¦${totalLoans.toLocaleString()}`;
        }

        function loadPendingDeposits() {
            const pendingList = document.getElementById('pendingDeposits');
            const pending = depositRequests.filter(req => req.status === 'pending');
            
            if (pending.length === 0) {
                pendingList.innerHTML = '<p style="text-align: center; padding: 20px;">No pending deposit requests</p>';
                return;
            }
            
            pendingList.innerHTML = pending.map(req => `
                <div class="transaction-item" style="border: 2px solid var(--primary-color); margin-bottom: 15px; padding: 15px; border-radius: 8px;">
                    <div class="transaction-left">
                        <strong>${req.userName}</strong><br>
                        <small>${req.userEmail}</small><br>
                        <strong>Amount:</strong> â‚¦${req.amount.toLocaleString()}<br>
                        <strong>Ref:</strong> ${req.transactionRef}<br>
                        <small>Requested: ${new Date(req.requestDate).toLocaleString()}</small>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-success" onclick="approveDeposit(${req.id})">Approve</button>
                        <button class="btn btn-danger" onclick="rejectDeposit(${req.id})">Reject</button>
                    </div>
                </div>
            `).join('');
        }

        function loadAdminUserSelect() {
            const userSelect = document.getElementById('adminUserSelect');
            const regularUsers = users.filter(u => u.email !== 'admin@easyfund.com');
            
            userSelect.innerHTML = '<option value="">Select a user</option>' + 
                regularUsers.map(user => `<option value="${user.id}">${user.name} (${user.email}) - â‚¦${user.wallet.toLocaleString()}</option>`).join('');
        }

        function approveDeposit(requestId) {
            const request = depositRequests.find(req => req.id === requestId);
            if (!request) return;
            
            // Find the user and credit their wallet
            const user = users.find(u => u.id === request.userId);
            if (user) {
                user.wallet += request.amount;
                addTransaction(user.id, 'deposit', request.amount, `Admin approved deposit - Ref: ${request.transactionRef}`);
                
                // Update current user if it's the same person
                if (currentUser && currentUser.id === user.id) {
                    currentUser.wallet = user.wallet;
                    updateWalletDisplay();
                }
                
                // Mark request as approved
                request.status = 'approved';
                request.approvedDate = new Date();
                
                saveAllData();
                loadPendingDeposits();
                updateAdminStats();
                loadAdminUserSelect();
                
                showNotification(`Deposit of â‚¦${request.amount.toLocaleString()} approved for ${request.userName}`);
            }
        }

        function rejectDeposit(requestId) {
            const request = depositRequests.find(req => req.id === requestId);
            if (!request) return;
            
            const reason = prompt('Reason for rejection (optional):') || 'No reason provided';
            
            request.status = 'rejected';
            request.rejectedDate = new Date();
            request.rejectionReason = reason;
            
            saveAllData();
            loadPendingDeposits();
            showNotification(`Deposit request from ${request.userName} has been rejected`);
        }

        function adminCreditUser() {
            const userId = parseInt(document.getElementById('adminUserSelect').value);
            const amount = parseFloat(document.getElementById('adminCreditAmount').value);
            
            if (!userId || !amount || amount <= 0) {
                alert('Please select a user and enter a valid amount');
                return;
            }
            
            const user = users.find(u => u.id === userId);
            if (!user) {
                alert('User not found');
                return;
            }
            
            if (!confirm(`Credit â‚¦${amount.toLocaleString()} to ${user.name}?`)) {
                return;
            }
            
            user.wallet += amount;
            addTransaction(user.id, 'admin_credit', amount, `Admin manual credit`);
            
            // Update current user if it's the same person
            if (currentUser && currentUser.id === user.id) {
                currentUser.wallet = user.wallet;
                updateWalletDisplay();
            }
            
            saveAllData();
            document.getElementById('adminCreditAmount').value = '';
            updateAdminStats();
            loadAdminUserSelect();
            
            showNotification(`â‚¦${amount.toLocaleString()} credited to ${user.name} successfully!`);
        }

        // Utility Functions
        function validatePassword(password) {
            const minLength = password.length >= 6;
            const hasNumber = /\d/.test(password);
            const hasLetter = /[a-zA-Z]/.test(password);
            
            return {
                isValid: minLength && hasNumber && hasLetter,
                errors: [
                    !minLength ? (currentLanguage === 'en' ? 'Password must be at least 6 characters' : 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„') : null,
                    !hasNumber ? (currentLanguage === 'en' ? 'Password must contain a number' : 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ù‚Ù…') : null,
                    !hasLetter ? (currentLanguage === 'en' ? 'Password must contain a letter' : 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±Ù') : null
                ].filter(Boolean)
            };
        }

        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function showNotification(message) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notif => notif.remove());
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);

            // Remove on click
            notification.onclick = () => notification.remove();
        }

        function startRealTimeUpdates() {
            setInterval(() => {
                if (currentUser) {
                    checkInvestmentMaturity();
                    autoSave();
                    
                    // Update dashboard if visible
                    if (!document.getElementById('dashboardContent').classList.contains('hidden')) {
                        updateDashboardStats();
                    }
                }
            }, 60000); // Every minute
        }

        function autoSave() {
            if (currentUser) {
                localStorage.setItem('easyfund_currentUser', JSON.stringify(currentUser));
                saveAllData();
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', initApp);

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
                setTimeout(() => {
                    event.target.style.display = 'none';
                }, 300);
            }
        }

        // Handle form submissions with Enter key
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const activeElement = document.activeElement;
                
                // Login form
                if (activeElement.closest('#loginForm')) {
                    e.preventDefault();
                    login();
                }
                
                // Signup form
                if (activeElement.closest('#signupForm')) {
                    e.preventDefault();
                    signup();
                }
                
                // Modal forms
                if (activeElement.closest('#depositModal')) {
                    e.preventDefault();
                    submitDepositRequest();
                }
                
                if (activeElement.closest('#withdrawModal')) {
                    e.preventDefault();
                    processWithdraw();
                }
            }
        });

        // Prevent zoom on double tap for iOS
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Enhanced error handling
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            showNotification(
                currentLanguage === 'en' ? 
                'An error occurred. Please refresh the page if issues persist.' :
                'Ø­Ø¯Ø« Ø®Ø·Ø£. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±Øª Ø§Ù„Ù…Ø´Ø§ÙƒÙ„.'
            );
        });

        // Handle online/offline status
        window.addEventListener('online', function() {
            showNotification(
                currentLanguage === 'en' ? 
                'Connection restored' :
                'ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„'
            );
        });

        window.addEventListener('offline', function() {
            showNotification(
                currentLanguage === 'en' ? 
                'You are offline. Some features may not work.' :
                'Ø£Ù†Øª ØºÙŠØ± Ù…ØªØµÙ„. Ù‚Ø¯ Ù„Ø§ ØªØ¹Ù…Ù„ Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙŠØ²Ø§Øª.'
            );
        });
    </script>
</body>
</html>
